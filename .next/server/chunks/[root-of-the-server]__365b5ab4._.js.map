{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/camilamota/Developer/app-astroglix/src/app/api/get-report/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { readFile, unlink } from 'fs/promises'\nimport { join } from 'path'\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const paymentId = searchParams.get('payment_id')\n\n    if (!paymentId) {\n      return NextResponse.json({\n        success: false,\n        error: 'ID de pagamento n√£o fornecido'\n      }, { status: 400 })\n    }\n\n    console.log('üîç Buscando dados para paymentId:', paymentId)\n\n    // Buscar dados salvos\n    const filePath = join(process.cwd(), 'tmp', `${paymentId}.json`)\n    \n    try {\n      const fileContent = await readFile(filePath, 'utf-8')\n      const savedData = JSON.parse(fileContent)\n      \n      console.log('‚úÖ Dados encontrados para:', paymentId)\n      \n      // Retornar dados para gerar o relat√≥rio\n      return NextResponse.json({\n        success: true,\n        data: savedData\n      })\n      \n    } catch (fileError) {\n      console.error('‚ùå Erro ao ler arquivo de dados:', fileError)\n      return NextResponse.json({\n        success: false,\n        error: 'Dados n√£o encontrados ou expirados'\n      }, { status: 404 })\n    }\n\n  } catch (error) {\n    console.error('üí• Erro na API get-report:', error)\n    \n    return NextResponse.json({\n      success: false,\n      error: 'Erro interno do servidor'\n    }, { status: 500 })\n  }\n}\n\nexport async function DELETE(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const paymentId = searchParams.get('payment_id')\n\n    if (!paymentId) {\n      return NextResponse.json({\n        success: false,\n        error: 'ID de pagamento n√£o fornecido'\n      }, { status: 400 })\n    }\n\n    // Limpar dados tempor√°rios ap√≥s gerar o relat√≥rio\n    const filePath = join(process.cwd(), 'tmp', `${paymentId}.json`)\n    \n    try {\n      await unlink(filePath)\n      console.log('üóëÔ∏è Dados tempor√°rios removidos para:', paymentId)\n      \n      return NextResponse.json({\n        success: true,\n        message: 'Dados removidos com sucesso'\n      })\n      \n    } catch (fileError) {\n      console.error('‚ö†Ô∏è Erro ao remover arquivo:', fileError)\n      return NextResponse.json({\n        success: false,\n        error: 'Erro ao limpar dados tempor√°rios'\n      }, { status: 500 })\n    }\n\n  } catch (error) {\n    console.error('üí• Erro na API delete-report:', error)\n    \n    return NextResponse.json({\n      success: false,\n      error: 'Erro interno do servidor'\n    }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,YAAY,aAAa,GAAG,CAAC;QAEnC,IAAI,CAAC,WAAW;YACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,OAAO;YACT,GAAG;gBAAE,QAAQ;YAAI;QACnB;QAEA,QAAQ,GAAG,CAAC,qCAAqC;QAEjD,sBAAsB;QACtB,MAAM,WAAW,CAAA,GAAA,iGAAA,CAAA,OAAI,AAAD,EAAE,QAAQ,GAAG,IAAI,OAAO,GAAG,UAAU,KAAK,CAAC;QAE/D,IAAI;YACF,MAAM,cAAc,MAAM,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD,EAAE,UAAU;YAC7C,MAAM,YAAY,KAAK,KAAK,CAAC;YAE7B,QAAQ,GAAG,CAAC,6BAA6B;YAEzC,wCAAwC;YACxC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,MAAM;YACR;QAEF,EAAE,OAAO,WAAW;YAClB,QAAQ,KAAK,CAAC,mCAAmC;YACjD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,OAAO;YACT,GAAG;gBAAE,QAAQ;YAAI;QACnB;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAE5C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;QACT,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF;AAEO,eAAe,OAAO,OAAoB;IAC/C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,YAAY,aAAa,GAAG,CAAC;QAEnC,IAAI,CAAC,WAAW;YACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,OAAO;YACT,GAAG;gBAAE,QAAQ;YAAI;QACnB;QAEA,kDAAkD;QAClD,MAAM,WAAW,CAAA,GAAA,iGAAA,CAAA,OAAI,AAAD,EAAE,QAAQ,GAAG,IAAI,OAAO,GAAG,UAAU,KAAK,CAAC;QAE/D,IAAI;YACF,MAAM,CAAA,GAAA,qHAAA,CAAA,SAAM,AAAD,EAAE;YACb,QAAQ,GAAG,CAAC,yCAAyC;YAErD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,SAAS;YACX;QAEF,EAAE,OAAO,WAAW;YAClB,QAAQ,KAAK,CAAC,+BAA+B;YAC7C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,OAAO;YACT,GAAG;gBAAE,QAAQ;YAAI;QACnB;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iCAAiC;QAE/C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;QACT,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF","debugId":null}}]
}